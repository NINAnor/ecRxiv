---
title: "Ecological status of surface water"
subtitle: |
  [NO_WECO_001] (fraction of rivers with good status) \
  [NO_WECO_002] (fraction of lakes with good status) \
  [NO_WECO_003] (fraction of coast with good status) \
  [NO_WECO_004] (fraction of rivers with good status or potential) \
  [NO_WECO_005] (fraction of lakes with good status or potential) \
  [NO_WECO_006] (fraction of coast with good status or potential) \
  [NO_WECO_007] (weighted fraction of rivers with good status) \
  [NO_WECO_008] (weighted fraction of lakes with good status) \
  [NO_WECO_009] (weighted fraction of coast with good status) \
  [NO_WECO_010] (average status of rivers) \
  [NO_WECO_011] (average status of lakes) \
  [NO_WECO_012] (average status of coast) \
format: 
  html:
    embed-resources: true
    code-fold: true
    toc: true
    toc-title: Contents
    toc-depth: 3
    smooth-scroll: true
execute: 
  cache: true
author:
  - name: Hanno Sandvik
    email: hanno.sandvik@nina.no
    affiliations:
      - id: myID
        name: Norwegian Institute for Nature Research
date: October 17, 2025 
callout-icon: false
lightbox: true
css: ../../../style.css
code-links:
      - text: Add a review
        icon: github
        href: https://github.com/NINAnor/ecRxiv
---

<!--# This is a template for how to document the indicator analyses. Make sure also to not change the order, or modify, the headers, unless you really need to. This is because it easier to read if all the indicators are presented using the same layout. If there is one header where you don't have anything to write, just leave the header as is, and don't write anything below it. If you are providing code, be careful to annotate and comment on every step in the analysis. Before starting it is recommended to fill in as much as you can in the metadata file. This file will populate the initial table in your output.-->

<!--# Load all you dependencies here -->

```{r setup}
#| include: false
library(knitr)
library(tidyverse)
library(kableExtra)
library(here)
knitr::opts_chunk$set(echo = TRUE)

library(foreign)
library(sf)
library(readxl)
#library(httr)
#library(jsonlite)
library(sp)
```

```{r source}
#| echo: false
source(here::here("_common.R"))
```

```{r}
#| echo: false
meta <- readxl::read_xlsx("../metadata.xlsx")
st <- meta |>
  filter(Variable == "status") |>
  pull(Value)
version <- meta |>
  filter(Variable == "Version") |>
  pull(Value)
auth <- meta |>
  filter(Variable == "authors") |>
  pull(Value)
year <- meta |>
  filter(Variable == "yearAdded") |>
  pull(Value)
id <- meta |>
  filter(Variable == "indicatorID") |>
  pull(Value)
name <- meta |>
  filter(Variable == "indicatorName") |>
  pull(Value)
url <- meta |>
  filter(Variable == "url") |>
  pull(Value)

meta <- meta |>
  mutate(Variable = case_match(Variable,
    "indicatorID" ~ "Indicator ID" ,
    "indicatorName" ~ "Indicator Name",
    "country" ~ "Country",
    "continent" ~ "Continent",
    "ECT" ~ "Ecosystem Condition Typology Class",
    "yearAdded" ~ "Year added",
    "yearLastUpdate" ~ "Last update",
    .default = Variable
   )
  ) |>
  filter(Variable != "authors")

```

<!--# The following parts are autogenerated. Do not edit. -->

```{r}
#| echo: false
#| results: asis
status(st)
```

::: {layout-ncol="2"}



> **Recommended citation**: `r paste("\n", auth, " ", year, ". ", name, " (ID: ", id[1], "--012) ", "v. ", version, ". ecRxiv: ", url, sep="")`

> **Version**: `r version`

:::

```{=html}
<details>
<summary>Show metadata</summary>
```

```{r tbl-meta}
#| tbl-cap: 'Indicator metadata'
#| echo: false
#| warning: false

meta |>
  select(Variable, Value) |>
  kbl(col.names = NULL) 

```

```{=html}
</details>
```

::: {.callout-tip collapse="true"}

## Logg

<!--# Update this logg with short messages for each update -->
- 12 Aug 2025 - Version 000.900 started: first complete version
- 17 Oct 2025 - Version 000.900 submitted to review
:::


<hr />

<!--# Document you work below.  -->

## 1. Summary

The [*Water Framework Directive*](#wfd) (hereafter **WFD**) has established a system to describe the ecological status of rivers (+&nbsp;canals), lakes (+&nbsp;reservoirs) and coastal waters (collectively referred to as *surface waters*). 
Within this framework, ecological status is assessed using a set of *parameters* (indicators) that express the condition of *biological quality elements* (aquatic flora, fish fauna, invertebrate fauna, phytoplankton) and *supporting elements* (hydromorphology, chemical and physico-chemical conditions) relative to anthropogenic *pressures* (such as acidification, eutrophication, pollution, regulation). 
Parameters are measured in (or transformed to) a common scale from 0 to 1, called *normalized Ecological Quality Ratio* (nEQR; equivalent to scaled indicators in [SEEA&nbsp;EA](#seeaea)). 
The overall status of a water body is determined by the quality element with the lowest nEQR (i.e., parameters are combined using the one-out--all-out principle rather than averaging).

Whereas several WFD parameters are applicable and valid as ecosystem condition indicators according to SEEA&nbsp;EA (see [section&nbsp;3.3](#collinearities-with-other-indicators)), Eurostat has also recommended the use of the "percentage of rivers and canals / lakes and reservoirs with *good ecological status*" (i.e., nEQR > 0.6) as an ecosystem condition indicator. 
However, such an indicator is incompatible with the SEEA&nbsp;EA guidelines and has undesirable mathematical properties: 
(**1**)&nbsp;many different parameters are combined in one *composite* index; 
(**2**)&nbsp;in doing so, the one-out--all-out (*1OAO*) principle is used; 
(**3**)&nbsp;values are not weighted by the *area* of the ecosystem assets; 
(**4**)&nbsp;the indicator uses *proportions* and cut-off values (0.6) rather than actual values (see [section&nbsp;3.6](#drawbacks) for more detail).

For these reasons, we discourage the use of this indicator. 
As it is recommended by Eurostat, however, we here document how it can be estimated, and how *some* (but emphatically not all) of its incompatibilities with SEEA&nbsp;EA can be removed by modifying its definition. 
The definitions suggested are 
(**A**)&nbsp;unweighted proportion of water bodies with at least good ecological status; 
(**B**)&nbsp;unweighted proportion of water bodies with at least good ecological status *or good ecological potential*; 
(**C**)&nbsp;*size-weighted* proportion of water bodies with at least good ecological status; 
(**D**)&nbsp;size-weighted *average* of ecological status or ecological potential (see [chapter&nbsp;9](#analyses) for more detail). 
With four indicator definitions and three ecosystem types (or "surface water categories" sensu WFD), a total of twelve indicators are described:

| Indicator ID | Ecosystem | Definition | Problem 1:<br />composite | Problem 2:<br />1OAO | Problem 3:<br />area | Problem 4:<br />proportion |
|:------------:|:---------:|:----------:|:-------------:|:-------------:|:-------------:|:---------------:|
| NO_WECO_001 | River         | A | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> |
| NO_WECO_002	| Lake          | A | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> |
| NO_WECO_003	| Coastal water | A | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> |
| NO_WECO_004	| River	        | B	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> |
| NO_WECO_005	| Lake          | B	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> |
| NO_WECO_006	| Coastal water | B	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:red">X</span> |
| NO_WECO_007	| River	        | C	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:green">✓</span> | <span style="color:red">X</span> |
| NO_WECO_008	| Lake          | C	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:green">✓</span> | <span style="color:red">X</span> |
| NO_WECO_009	| Coastal water | C	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:green">✓</span> | <span style="color:red">X</span> |
| NO_WECO_010	| River	        | D	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:green">✓</span> | <span style="color:green">✓</span> |
| NO_WECO_011	| Lake          | D	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:green">✓</span> | <span style="color:green">✓</span> |
| NO_WECO_012	| Coastal water | D	| <span style="color:red">X</span> | <span style="color:red">X</span> | <span style="color:green">✓</span> | <span style="color:green">✓</span> |

: {.striped .hover}

&nbsp;

In Norway, the WFD is implemented by means of [*Vannforskriften*](#vannf), and relevant parameters are described in national guidelines ([DGVF 2025](#veil2)). 
The status assessments of Norwegian water bodies are available from the [*Vann-nett*](#vannn) database.

> ### Interpretation
For indicators NO_WECO_001--009, a value of 1 signifies that all water bodies deviate only slightly, if at all, from undisturbed conditions; values decreasing toward zero reflect lower percentages of water bodies meeting this criterion. For indicators NO_WECO_010--012, a value of 1 signifies a condition where there is little or no human impact on the water body; values decreasing toward zero reflect negative ecological change.

<!--# 
With a maximum of 300 words, describe the indicator in general terms as you would to a non-expert. Think of this as a kind of commmon language summary. It is a good idea to include a bullet point list of the spesific steps in the workflow. Include a mention of the following aspects:

What does the metric represent?
Why is this relevant for describing ecosystem condition in this ecosystem?
What are the main anthropogenig impact factors?
What kind of data is used? 
Shortly, how is the data customized (modified, estimated, integarted) to fit its purpuse as an indicator?
What is the current status of  the metric (can it be used or is it still in development)?
How should the metric be used and interpretted, and how should it not be used/interpretted?
-->


## 2. About the underlying data

Information on the ecological status of all Norwegian water bodies is collected in a common database called [*Vann-nett*](#vannn), which is maintained by the [Norwegian Environment Agency](https://www.miljodirektoratet.no/).

<!--# Describe the data you have used in more detail, it's origin, biases, availability ect.-->

### 2.1 Spatial and temporal resolution and extent

The **spatial** resolution of WFD data is on the level of *water bodies*. 
The WFD defines a water body (specifically a "body of surface water") as "a discrete and significant element of surface water such as a lake, a reservoir, a stream, river or canal, [or] part of a stream, river or canal" (WFD, Article 2, paragraph 10; cf. *Vannforskriften* §&nbsp;3, letter a; for implementation, see [DGVF 2018](#veil1), ch. 2).

There is no specific **temporal** resolution, as measurements of WFD indicators are reported sporadically. 
The estimation of overall ecological status is based on measurements from the most recent six years within the ten-year interval up to and including the current year.

<!--# Describe the temporal and spatial resolution and extent of the data used -->

### 2.2 Sampling design

WFD indicators are mainly measured opportunistically, e.g. when and where some authority has a need to check whether a water body fulfils the management objective of the WFD. 
However, a subset of the measurements is taken systematically, e.g. repeated measurements in a sample of water bodies that have been selected following certain criteria.

<!-- How was the data sampled? Describe potential sampling biases -->

### 2.3 Original units

The ecological status of water bodies may be reported in terms of continuous nEQR values (normalized Ecological Quality Ratios) between 0 and 1, or in terms of five discrete categories (see section on [reference levels](#reference-levels) below).

<!--# What are the original units for the most relevant  variables in the data-->

### 2.4 Instructions for citing, using and accessing data

The data used are publicly available but not machine-readable. 
They need to be downloaded manually from a database called *Vann-nett* via the link [https://vann-nett.no/waterbodies/report](https://vann-nett.no/waterbodies/report). 
See [*Vann-nett*](#vannn) for how to cite the dataset.

<!--# Is the data openly available? If not, how can one access it? What are the key references to the datasets?   -->


## 3. Indicator properties

Ecological status of surface water has the ID **131** in the metadata table for ecological condition variables for use in Norway ([Czúcz et al. 2023](#czu23)).

Eurostat has listed the percentage of water bodies with good ecological status as a *voluntary condition variable* for reporting in connection with the EU Regulation 2024/3024 ([EU 2024](#eu24), Annex&nbsp;IX; cf. [Czúcz el at. 2025](#czu25)).

### 3.1 Ecosystem Condition Typology Class (ECT)

Being a composite index across a large number of individual WFD parameters, the "ecological status of surface water" potentially covers all ECT classes. 
The best represented class is probably **A2** (chemical state), but WFD parameters belonging to A1, B1, B2, B3 and possibly C1 are also included when estimating index values.

<!--# 
Describe the rationale for assigning the indicator to the ECT class. See https://oneecosystem.pensoft.net/article/58218/
This doesnt need to be very long. Maybe just a single sentence. 
-->

#### 3.1.1 Other condition typologies

Being a composite index across a large number of individual WFD parameters, the "ecological status of surface water" potentially covers all ecological characteristics (*økologiske egenskaper*) sensu Nybø & Evju ([2017](#nyb17), p.&nbsp;35) and all biological quality elements sensu WFD (Annex&nbsp;V).

<!--# Optional: Add text about other spesific standards, e.g. national standards, and how the indicator relates to these -->
### 3.2 Ecosystem condition characteristic

Not applicable.

<!--# 
Describe the ecosystem condition characteristic represented in the indicator. See 10.3897/oneeco.6.e58218 for information on what these characteristics might be.
For example, and indicator called 'Trenching in mires' could be made to represent an ecosystem characteristic 'Intact hydrology'. The term 'characteristic' is used similar to the term 'criteria' in Multiple Criteria Decition Making.  
-->

### 3.3 Collinearities with other indicators

Being a composite index calculated from a large number of individual WFD parameters, the "ecological status of surface water" necessarily has collinearities with at least some -- and potentially all -- of these parameters. 
(As the one-out--all-out principle is used, it may be the case that a certain parameter always indicates a better ecological status than all others, in which case there would be no collinearity between this specific parameter and the composite index.)

The WFD parameters that have been implemented as ecosystem condition indicators in Norway as of 2025 are:

| Parameter Name | Indicator ID | Ecosystem | ECT | Quality element | Pressure |
|:---------------|:------------:|:---------:|:---:|:---------------:|:--------:|
| RAMI | [NO_WAMI_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WAMI_001) | River | A2 | invertebrate fauna | acidification |
| ASPT | [NO_WSPT_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WSPT_001) | River | A2 | invertebrate fauna | eutrophication |
| AIP | [NO_WAIP_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WAIP_001) | River | A2 | aquatic flora | acidification |
| PIT | [NO_WPIT_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WPIT_001) | River | A2 | aquatic flora | eutrophication |
| Chlorophyll *a* | [NO_WCHL_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WCHL_001) | Lake | B2 | phytoplankton | eutrophication |
| Phytoplankton<br />biomass (PPB) | [NO_WPPB_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WPPB_001) | Lake | B2 | phytoplankton | eutrophication |
| PTI | [NO_WPTI_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WPTI_001) | Lake | A2 | phytoplankton | eutrophication |
| Acid-neutralising<br />capacity (ANC) | [NO_WANC_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WANC_001_002) | River | A2 | chemical | acidification |
| ANC | [NO_WANC_002](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WANC_001_002) | Lake | A2 | chemical | acidification |
| Labile aluminium | [NO_WLAL_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WLAL_001_002) | River | A2 | chemical | acidification |
| Labile aluminium | [NO_WLAL_002](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WLAL_001_002) | Lake | A2 | chemical | acidification |
| pH | [NO_WPHX_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WPHX_001_002) | River | A2 | chemical | acidification |
| pH | [NO_WPHX_002](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WPHX_001_002) | Lake | A2 | chemical | acidification |
| (Total nitrogen) | [NO_WTNX_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WTNX_001_002) | River | A2 | chemical | eutrophication |
| (Total nitrogen) | [NO_WTNX_002](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WTNX_001_002) | Lake | A2 | chemical | eutrophication |
| Total phosphorus | [NO_WTPX_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WTPX_001_002) | River | A2 | chemical | eutrophication |
| Total phosphorus | [NO_WTPX_002](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WTPX_001_002) | Lake | A2 | chemical | eutrophication |
| Water level<br />regulation | [NO_WLEV_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_WLEV_001) | Lake | A1 | hydromorphology | regulation |

: {.striped .hover}

&nbsp;

In contrast to "ecological status of surface water", the above indicators (except total nitrogen, which cannot be scaled and is deprecated) are fully compatible with [SEEA&nbsp;EA](#seeaea). 
SEEA&nbsp;EA (5.79--90) also suggests defining aggregated *indices* that are calculated from sets of similar indicators, e.g. as a weighted average of all ecosystem condition indicators for lakes. 
This procedure is thus preferable to using "ecological status of surface water" as an indicator in its own right.
To illustrate how this might be carried out in line with "WFD thinking" (as described in [DGVF 2025](#veil2)), one can assign the same weight to each pressure, and downweight chemical indicators to get the same cumulative weight as one biological indicator.

For rivers, such an index might thus be calculated as

`(ASPT / 3 + PIT / 3 + TP / 3) / 2 + (RAMI / 3 + API / 3 + ANC / 9 + LAL / 9 + PH / 9) / 2`.

Analogously, a lake condition index might be calculated as

`(PTI / 3 + CHL / 6 + PPB / 6 + TP / 3) / 3 + (ANC / 3 + LAL / 3 + PH / 3) / 3 + WLEV / 3`.

These index definitions only include WFD indicators. 
Other freshwater indicators (such as salmon stock quality, [NO_SALM_001](https://github.com/NINAnor/ecRxiv/tree/main/indicators/NO_SALM_001)) can -- and should -- be included following the same approach.

<!--# Describe known collinearities with other metrices (indicators or variables) that could become problematic if they were also included in the same Ecosystem Condition Assessment as the indicator described here. -->

### 3.4 Impact factors

Being a composite index across a large number of individual WFD parameters, the "ecological status of surface water" potentially covers all relevant anthropogenic impacts (pressures), including acidification, eutrophication, pollution, and possibly regulation.

<!--# Describe the main natural and anthropogenic factors that affecst the metric -->

### 3.5 Spatial aggregation

According to the WFD and DGVF ([2025](#veil2)), measurements of WFD variables are transformed into so-called nEQR values ("normalised Ecological Quality Ratios") between 0 and 1, which correspond to indicator values sensu [SEEA&nbsp;EA](#seeaea) (see [section&nbsp;4.2](#reference-levels)). 
This involves the following steps:

1. *Truncation.* Variable values are truncated, where measurements that are poorer than X~0~ are set to X~0~, and measurements that are better than X~100~ are set to X~100~.
2. *Scaling.* The truncated variable values are linearly scaled so that X~0~ becomes 0 and X~100~ becomes 1. The resulting indicator values are referred to as **EQR**s ("Ecological Quality Ratios").
3. *Transformation.* EQR values are transformed in a stepwise-linear manner, so that the indicator values 0.2, 0.4, 0.6 and 0.8 correspond to the thresholds between the normative definitions of "bad", "poor", "moderate", "good" and "high" ecological status according to the WFD. The resulting indicator values are referred to as **nEQR**s ("normalised EQRs").
4. *Summary statistics.* Instead of spatial aggregation, the proportion of water bodies fulfilling the normative objective of the WFD is calculated.

Two of the indicator definitions considered below ([**A**](#indicator-definition-a) and [**B**](#indicator-definition-b), indicators NO_WECO_001--006) follow the same procedure. 
The two remaining definitions ([**C**](#indicator-definition-c) and [**D**](#indicator-definition-d), indicators NO_WECO_007--012) replace summary statistics (step&nbsp;4) by area-weighted arithmetic averages, i.e. proper spatial aggregation.

<!-- Describe in word the same aggregation pathway presented in the metadata.xlsx. If you have scaled against the reference value, it is especially important to know if you did any avergaing or summations etc. beforehand. An example text for a rather simple case could be: "The variable is scaled at the initial polygon level and the point estimate is a area-weighted arithmetic mean of all polygins. There is no transformation, and truncation is not needed as the indicator becomes naturally bound between 0 and 1". -->

### 3.6. Drawbacks

Ecological status of surface water is a variable recommended for ecosystem condition accounting by Eurostat (see [Czúcz et al. 2025](#czu25)). 
However, the [indicator definition suggested by Eurostat](#indicator-definition-a) (and, to a lesser degree, the [modifications tested below](#analyses)) has at least four undesirable properties, which makes it incompatible with the [SEEA&nbsp;EA](#seeaea) guidelines. 
These are:

1. *The indicator combines many different WFD parameters in one composite index.* SEEA&nbsp;EA emphasises that ecosystem condition variables are meant to be "quantitative metrics describing *individual characteristics* of an ecosystem asset" (SEEA&nbsp;EA, 5.41, emphasis changed), should "reflect a role in ecosystem processes" (SEEA&nbsp;EA, 5.42), and should belong to a specific ECT class (SEEA&nbsp;EA, 5.46). By aggregating information across various ecosystem characteristics, quality elements and ECTs, the indicator "ecological status" violates these principles, and it also violates the criteria of intrinsic relevance and simplicity (SEEA&nbsp;EA, A5.1). Although warning that the "aggregation of a variety of indicators can conceal important information reflected in individual indicators", SEEA&nbsp;EA provides the (optional) possibility of deriving "aggregate ecosystem condition indices" (SEEA&nbsp;EA, 5.79). Such indices, however, are to be "aggregated from the combination of *individual ecosystem condition indicators* recorded in the ecosystem condition indicator account" (SEEA&nbsp;EA, 5.81, emphasis changed). See [section&nbsp;3.3](#collinearities-with-other-indicators) for how this might be done for freshwater ecosystems.
2. *The different parameters are combined using the one-out--all-out (1OAO) principle, rather than averaging.* This implies that, of all parameters measured or assessed for a water body, the parameter having the *lowest* nEQR (poorest status) determines the value of the indicator. An ecosystem condition account should provide an unbiased summary of the overall condition, but the 1OAO principle deliberately distorts this summary. Whereas the 1OAO principle makes sense in the context of water management -- as it directs the management authorities' attention to the specific parameter(s) that fall(s) short of reaching the management goal for a specific water body --, the same principle is thus less suited in the context of ecosystem (condition) accounting (see discussion in SEEA&nbsp;EA, 5.95).
3. *The geographical aggregation of the indicator ignores the size of the ecosystem assets (water bodies).* This violates SEEA&nbsp;EA's principle that "the values recorded in an ecosystem condition variable account should be calculated as the *area-weighted arithmetic mean of ecosystem
assets* belonging to the particular ecosystem type" (SEEA&nbsp;EA, 5.54, emphasis added). Area-weighted averaging is recommended because it "results in a condition variable account that describes the average values of variables for an ecosystem type within an E[cosystem&nbsp;]A[ccounting&nbsp;]A[rea]" (ibidem).
4. *The indicator is defined in terms of the proportion of ecosystem assets above a certain cut-off value (0.6).* To illustrate the weakness of this approach, assume that all water bodies have identical nEQR values. In this case, an increase in ecological status from, e.g., 0.21 to 0.59, or a decrease from 0.99 to 0.61, would be entirely invisible from the indicator (which would have a constant value of 0.00 in the first case, and 1.00 in the second case), whereas a much smaller change from 0.59 to 0.61 would result in the indicator value switching from 0.00 to 1.00. Although these examples are deliberately chosen to be extreme, they illustrate the enormous loss of information when a continuous variable is transformed into a binary one. A further aspect of this problem is that proportions are rather uninformative at the level of a single ecosystem asset (where they can only take the values 0 or 1). Whereas proportions may be informative at higher geographical scales (e.g. at the level of countries, counties and possibly municipalities), SEEA&nbsp;EA indicators are meant to be informative at the scale of single ecosystem assets, wherever possible (SEEA&nbsp;EA, 5.16--5.22).


## 4. Reference condition and levels

### 4.1 Reference condition

The WFD defines the reference condition of a water body as "the condition of a quality element where there is little or no human impact on the water body. 
The reference condition is therefore also referred to as the natural condition" ([DGVF 2025](#veil2)).

Reference conditions may be specific to certain water-body types. 
Water bodies judged to be in the reference condition are referred to as *reference water bodies*.

<!--# Define the reference condition (or refer to where it is defined). Note the distinction between reference condition and reference levels 10.3897/oneeco.5.e58216  -->

### 4.2 Reference levels

According to the WFD, reference levels for a given parameter (indicator) are defined for X~0~, X~20~, X~40~, X~60~, X~80~, and X~100~. 
These are used to classify the "ecological status" of water bodies as "bad" (X~0~ &le; X &le; X~20~), "poor" (X~20~ < X &le; X~40~), "moderate" (X~40~ < X &le; X~60~), "good" (X~60~ < X &le; X~80~), and "high" (X~80~ < X &le; X~100~). 
The WFD (Annex&nbsp;V, section&nbsp;1.2) provides the following normative definition of "high status": 
"The values of the biological quality elements for the surface water body reflect those normally associated with that type under undisturbed conditions, and show no, or only very minor, evidence of distortion."

Being a composite index across a large number of individual WFD parameters, the "ecological status of surface water" does not have its own reference levels but is calculated, for each water body, from the ecological status categories of the underlying parameters. 

An exception from this procedure is made for so-called *heavily modified water bodies*, which are water bodies that cannot achieve good ecological status due to substantial "changes to the hydromorphological characteristics" necessitated by "important sustainable human development activities", such as navigation, power generation, drinking-water supply, water regulation or recreation (WFD, Article&nbsp;4, paragraph&nbsp;3; cf. *Vannforskriften* §&nbsp;5). 
Heavily modified water bodies are assessed in terms of four categories of *ecological potential* (rather than ecological status), namely "bad", "poor", "moderate" and "good". 
Although no official transformation scheme between ecological potential category and nEQR exists, this may be done in analogy to ecological status. 
As the definition of heavily modified water bodies implies that they cannot reach "good status", the upper boundary of ecological potential may be set at an nEQR of 0.6 (i.e. the lower boundary of "good status"), and the thresholds between the four categories at 0.15, 0.30 and 0.45, respectively.

<!--# 
If relevant (i.e. if you have normalised a variable), describe the reference levels used to normalise the variable. 

Use the terminology where X~0~ refers to the reference level (the variable value) denoting the worst possible condition; X~100~denotes the optimum or best possible condition; and X~*n*~, where in is between 0 and 100, denotes any other anchoring points linking the variable scale to the indicator scale (e.g. the threshold value between good and bad condition X~60^). 

Why was the current option chosen and how were the reference levels quantified? If the reference values are calculated as part of the analyses further down, please repeat the main information here.
-->

#### 4.2.1 Spatial resolution and validity

The spatial resolution of WFD reference levels is the water body. 

<!--# 
Describe the spatial resolution of the reference levels. E.g. is it defined as a fixed value for all areas, or does it vary. Also, at what spatial scale are the reference levels valid? For example, if the reference levels have a regional resolution (varies between regions), it might mean that it is only valid and correct to use for normalising local variable values that are first aggregated to regional scale. However, sometimes the reference levels are insensitive to this and can be used to scale variables at the local (e.g. plot) scale. 
-->


## 5. Uncertainties

### 5.1 General uncertainties

The main source of uncertainty for this indicator is the *sampling error* of the underlying WFD parameters, since these are only sampled in a small fraction of all water bodies. 
Water bodies for which no WFD parameters have been measured, are assigned to an ecological status category based on expert judgement. 

A further source of uncertainty is methodological, viz. that *Vann-nett* represents ecological status in terms of status categories rather than the underlying nEQR values. 
This entails rounding of a continuous number between 0.0 and 1.0, to the nearest odd multiple of 0.1, i.e. an enormous loss of information. 
(This is not so by necessity but by pure convention, as the operations involved in integrating different parameter values into an overall index value, are *means* and *minima*, none of which requires rounding.) 
This second uncertainty is mainly relevant for the relatively small fraction of water bodies for which measurements of WFD parameters are available, so it may be said to "drown" in the first uncertainty.

<!--# Describe the main reasons why you might not trust 100% the final value to represent the given ecosystem characteristic for the give ecosystem type. What aspects of this condition metric are most sensitive to subjective decitions? Is the spatial sampling sufficient? Does the choice of modeling framework affect the values? Is the metric relevant do describe ecosystem condition for the give ecosystem type?  -->

### 5.2 Reported uncertainties

Both sources of uncertainty are here quantified using simulations ([see below](#random)). 
The uncertainties reported are thus inferential, i.e. they refer to the uncertainty around the point estimates. 
In the dataset used, "precision" is reported as either "high", "intermediate" or "low". 
This refers to the confidence that the ecological status category reported for a given water body is correct. 
If, e.g., a water body is reported to have "good status" with "low precision" (e.g., expert judgement), the real ecological status may well be "high" or "moderate".
This information is used to define the width of the intervals from which random numbers are drawn during simulations.
Quartiles (or, if needed, other error estimates) are then obtained from the sample of random numbers drawn. 

<!-- Describe the nature of the errors you (hopefully) provide alongside the point estimate for the condition metric. It is especially important to clarify if the errors are inferential (referring to the uncertainty of the point estimate) or descriptive (referreing to the data itself). Here' an example text: "What we report as uncertainties in @tbl-finalTable are inferential and refer to the uncertainty around the point estimates. It does not directly describe variation in the data itself. 
However, the variation in the mean is defined by the spatial variation only, and quartiles are obtained by bootstrapping the set of localities within a region, and calculating the indicator for each of 9999 such samples".   -->


## 6. References

<span id="czu23">Czúcz B, Sandvik H, Framstad E & Schartau AK.</span> 2023. Metadata for ecological condition variables for use in Norway, version 1.0. [[doi:10.5281/zenodo.10187828](https://doi.org/10.5281/zenodo.10187828)]

<span id="czu25">Czúcz B, Framstad E, Clappe S & Nowell M.</span> 2025. Exploring the use of Eurostat's mandatory and voluntary indicators in Norway. *NINA Rep* **2604**: in press. [[hdl:11250/3199708](https://hdl.handle.net/11250/3199708)]

<span id="veil1">DGVF [Direktoratsgruppa for vannforvaltning].</span> 2018. *Veileder 1:2018 Karakterisering. Metodikk for å karakterisere og vurdere miljømålsoppnåelse etter vannforskriftens § 15.* Miljødirektoratet, Trondheim. <https://www.vannportalen.no/veiledere/veileder-12018-karakterisering-metodikk-fora-karakterisere-og-vurdere-miljooppnaelse-etter-vannforskriften--15/>

<span id="veil2">DGVF [Direktoratsgruppa for vannforvaltning].</span> 2025. *Veileder for klassifisering av miljøtilstand i kyst- og ferskvann* [version of 28 Jan 2025]. Vannportalen. <https://www.vannportalen.no/veiledere/klassifiseringsveileder/>

<span id="env25">Environment Agency & Natural England.</span> 2025. State of the water environment indicator B3: supporting evidence. <https://www.gov.uk/government/publications/state-of-the-water-environment-indicator-b3-supporting-evidence/state-of-the-water-environment-indicator-b3-supporting-evidence>

<span id="eu24">EU.</span> 2024. Regulation (EU) 2024/3024 of the European Parliament and of the Council of 27 November 2024 amending Regulation (EU) No 691/2011 as regards introducing new environmental economic account modules. [[CELEX:32024R3024](http://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=CELEX:32024R3024:en:NOT)]

<span id="vannn">Miljødirektoratet.</span> 2025. *Vann-nett*. <https://vann-nett.no/>

<span id="nyb17">Nybø S & Evju M (eds).</span> 2017. *Fagsystem for fastsetting av god økologisk tilstand. Forslag fra et ekspertråd.* Klima- og miljødepartementet, Oslo. <https://www.regjeringen.no/id2558481/>

<span id="san25">Sandvik H.</span> 2025. WFD2ECA: Dataflyt fra vannforskriften til økologisk tilstandsregnskap og naturindeks, version 2.0. <https://github.com/NINAnor/WFD2ECA> [[doi:10.5281/zenodo.10278000](https://doi.org/10.5281/zenodo.10278000)]

<span id="seeaea">**SEEA EA**:</span> United Nations et al. 2024. *System of Environmental-Economic Accounting -- Ecosystem Accounting.* UN, New York. <https://seea.un.org/ecosystem-accounting>

<span id="vannf">**Vannforskriften**.</span> 2006. Forskrift om rammer for vannforvaltningen. *Nor Lovtid I* **2006**: 2004--2034. [[FOR-2006-12-15-1446](https://lovdata.no/dokument/SF/forskrift/2006-12-15-1446)]

<span id="wfd">**WFD**:</span> EU. 2000. Directive 2000/60/EC of the European Parliament and of the Council of 23 October 2000 establishing a framework for Community action in the field of water policy. *Off J EU L* **43** (327): 1--72. [[CELEX:32000L0060](http://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=CELEX:32000L0060:en:NOT)]
  
<!--# You can add references manually or use a citation manager and add intext citations as with crossreferencing and hyperlinks. See https://quarto.org/docs/authoring/footnotes-and-citations.html -->


## 7. Import and prepare datasets

<!--# Describe the unique datasets seperately under seperate headers (Dataset A, Dataset B, etc.-->

### 7.1. Vann-nett

Information on all Norwegian water bodies is publicly available from a database called *Vann-nett* via the link [https://vann-nett.no/waterbodies/report](https://vann-nett.no/waterbodies/report). 
This information includes size, ecological status, ecological potential, chemical status, among many other parameters. 
Data can be downloaded manually from this database.

A download from *Vann-nett* is a snapshot of the status quo. 
The download used here is from 15 August 2025. 
For this reason, it is not possible to estimate exact values for 2024 any more. 
One can assume, however, that only a minor proportion of water bodies has changed its ecological status between 31 December 2024 and 15 August 2025.

The spreadsheets downloaded from *Vann-nett*, one for each surface water category, need to be read.

```{r}
VC <- as.data.frame(read_xlsx("../data/VN-C.xlsx", col_types = "text"))
VL <- as.data.frame(read_xlsx("../data/VN-L.xlsx", col_types = "text"))
VR <- as.data.frame(read_xlsx("../data/VN-R.xlsx", col_types = "text"))
V <- rbind(VL, VR, VC)
rm(VC, VL, VR)
```

This is how the dataset looks like:

```{r}
head(V)
```

<!--# Describe the main dataset, typicaly the one containing the variable of (most) interest. Change the header from Dataset A to the name of the actual dataset. -->


## 8. Spatial units

Data are reported per water bodies, which correspond to the Ecosystem Assets of freshwater ecosystems. 
The Ecosystem Accounting Area covered by the data is mainland Norway. 

<!--# 
Describe the spatial units that you rely on in your analyses. Highlight the spatial units (the resolution) that the indicator values should be interpretted at. Potential spatial delineation data should eb introduced under 7.1. Datasets. We recomend using the SEEA EA terminology opf Basic Spatial Units (BSU), Ecosystem Asses (EA) and Ecosystem Accounting Area (EAA). 
-->


## 9. Analyses

### 9.1. Preparing and testing the data

We start by loading some functions and data from the [WFD2ECA](https://github.com/NINAnor/WFD2ECA/) repository ([Sandvik 2025](#san25)), which will be used in the following analyses.

```{r}
source(url("https://github.com/NINAnor/WFD2ECA/raw/refs/heads/main/R/Funksjon.R" ))
load(  url("https://github.com/NINAnor/WFD2ECA/raw/refs/heads/main/data/VF.RData"))
```

In addition, some specialised functions need to be defined for translating ecological status or potential scores into nEQRs, and for creating randomising nEQR values under different uncertainty conditions.

```{r}
# Function returning the midpoint nEQR of each ecological status category
status2nEQR <- function(status) return(
  ifelse(status == "Svært god",    0.9,
  ifelse(status == "God",          0.7,
  ifelse(status == "Moderat",      0.5,
  ifelse(status == "Dårlig",       0.3,
  ifelse(status == "Svært dårlig", 0.1,
  NA)))))
)



# Function returning the midpoint nEQR of each ecological potential category
potential2nEQR <- function(potential) return(
  ifelse(potential == "Godt",         0.525,
  ifelse(potential == "Moderat",      0.375,
  ifelse(potential == "Dårlig",       0.225,
  ifelse(potential == "Svært dårlig", 0.075,
  NA))))
)



# Function creating random nEQR values for estimates of low uncertainty
lowUncertainty <- function(m, pot = FALSE) {
  L <- length(m)
  U <- if (pot) 0.6 else 1
  D <- if (pot) 0.075 else 0.1
  m[] <- m[] + runif(L, -D, +D)
  return(sapply(sapply(m[], max, 0), min, U))
}



# Function creating random nEQR values for estimates of indermediate uncertainty
intermediateUncertainty <- function(m, pot = FALSE) {
  L <- length(m)
  U <- if (pot) 0.6 else 1
  D <- if (pot) 0.15 else 0.2
  R <- runif(L)
  m <- m - D/2
  m[] <- ifelse(R < 0.125, m[]     - rbeta(L, 1, 2) * D / 3,
         ifelse(R > 0.875, m[] + D + rbeta(L, 1, 2) * D / 3,
                           m[]     + runif(L, 0, 1) * D))
  return(sapply(sapply(m, max, 0), min, U))
}



# Function creating random nEQR values for estimates of high uncertainty
highUncertainty <- function(m, pot = FALSE) {
  L <- length(m)
  U <- if (pot) 0.6 else 1
  D <- if (pot) 0.15 else 0.2
  R <- runif(L)
  m <- m - D/2
  m[] <- ifelse(R < 0.25, m[]     - rbeta(L, 1, 2) * D,
         ifelse(R > 0.75, m[] + D + rbeta(L, 1, 2) * D,
                          m[]     + runif(L, 0, 1) * D))
  return(sapply(sapply(m[], max, 0), min, U))
}
```

We define the quantiles we want to estimate for each indicator as the median, the quartiles and the lower/upper 95% confidence levels.

```{r}
Qnt <- c(0.025, 0.25, 0.5, 0.75, 0.975)
```

The data from *Vann-nett* need to be prepared for analysis.

```{r}
# Column names are changed so that they match the ones used in the WFD2ECA repo:
names(V) <- c("id", "nam", "kat", "areal", "nas", "smvf", 
              "kjetil", "kjepre", "okopre", "okopot", 
              "okotil", "okomal", "kjemal", "potmal", 
              "fylke", "kommune")

# Replace Norwegian water surface categories by WFD abbreviations:
V$kat <- erstatt(V$kat, "Elv",      "R")
V$kat <- erstatt(V$kat, "Innsjø",   "L")
V$kat <- erstatt(V$kat, "Kystvann", "C")

# Turn area into a numerical variable:
V$areal <- as.numeric(erstatt(V$areal, ",", "."))

# Turn heavily modified water bodies into a logical variable:
V$smvf <- V$smvf == "Sterkt modifisert"

# Define colours according to the WFD colour scheme:
V$farge <- suppressWarnings(farge(status2nEQR(V$okotil), 0.6))

# Insert geographical coordinates:
V$lat <- V$lon <- as.numeric(NA)
for (i in 1:nrow(V)) {
  w <- which(vf$id == V$id[i])
  if (length(w) %=% 1) { # NB: the dataframe "vf" was read from the WFD2ECA repo
    V$lat[i] <- vf$lat[w]
    V$lon[i] <- vf$lon[w]
  }
}
```

The resulting dataset can be shown an a map ...

```{r}
#| lab: measurement-map
#| fig-cap: "Map of all river and lake water bodies in Norway, using WFD colour coding for ecological status classes."

par(mai = rep(0, 4))
plot(V$lon, V$lat, bty = "n", xaxt = "n", yaxt = "n", asp = 2,
     pch = 20, col = V$farge, cex = 0.2)
for (i in seq(0.1, 0.9, 0.2)) {
  rect(21, 61 + (i - 0.1) * 6, 23, 61 + (i + 0.1) * 6, col = farge(i), lwd = 2)
}
rect(21, 59, 23, 60.2, col = grey(0.84), lwd = 2)
text(23, 59 + 0.1 * 6, "heavily modified", pos = 4)
text(23, 61 + 0.1 * 6, "bad", pos = 4)
text(23, 61 + 0.3 * 6, "poor", pos = 4)
text(23, 61 + 0.5 * 6, "moderate", pos = 4)
text(23, 61 + 0.7 * 6, "good", pos = 4)
text(23, 61 + 0.9 * 6, "high", pos = 4)
text(6, 70, "ecological\nstatus", cex = 1.5, font = 2)
```

... and tabulated.

```{r}
{
  cat("Inspection of the dataset:\n")
  cat("--------------------------\n")

  cat("\nHeavily modified (TRUE) and natural (FALSE) water bodies:")
  print(table(V$smvf, useNA = "always"))

  cat("\nDistribution of ecological status categories:")
  print(table(V$okotil, useNA = "always"))

  cat("\nDistribution of ecological potential categories:")
  print(table(V$okopot, useNA = "always"))

  cat("\nDistribution of precision categories:")
  print(table(V$okopre, useNA = "always"))

  cat("\nDistribution of surface water categories:")
  print(table(V$kat, useNA = "always"))

  cat("\nDistribution of water body areas (in km²):\n")
  print(summary(V$areal[which(V$kat != "R")]))

  cat("\nDistribution of lengths of river water bodies (in km):\n")
  print(summary(V$areal[which(V$kat == "R")]))
}
```

The inspection has not revealed any unexpected data.
We can now transform the ecological status categories into a numerical variable by replacing each category by the midpoint of its nEQR range.

```{r}
nsim <- 1000
# The values tabulated in the "Results" section were obtained using nsim = 10000

{
  nEQR <- matrix(status2nEQR(V$okotil), nrow(V), nsim)
  cat("Distribution of nEQR values among natural water bodies:\n")
  print(table(nEQR[which(!V$smvf), 1], useNA = "always"))
}
```

For *heavily modified water bodies* ([see above](#reference-levels)), the relevant measure is their *ecological potential* rather than ecological status. 
Unfortunately, there is no established conversion from ecological potential to nEQR values. 
As a defining property of heavily modified water bodies is that they cannot reach "good" ecological status, however, it makes sense to define the upper boundary of ecological potential as 0.6 (which is the lower boundary of good ecological status), and to evenly distribute the four categories for ecological potential along the range between 0.0 and 0.6.

```{r}
{
  w <- which(V$smvf)
  nEQR[w, ] <- potential2nEQR(V$okopot[w])
  cat("Approximated nEQR values among heavily modified water bodies:\n")
  print(table(nEQR[which(V$smvf), 1], useNA = "always"))
}
```

<span id="random">Randomisation</span> is used in order to quantify uncertainties. 
For each water body, *Vann-nett* provides the precision of its classification (i.e. its assignment to an ecological status or potential category). 
These are handled as follows:

1. "High precision" entails that the category is assigned based on an sufficient amount of actual measurements, and that their standard deviation is not close to a reference level. In these cases, the category as such can be regarded as certain, and uncertainty is restricted to the exact nEQR value within the interval defined by the category. The following randomisation draws random numbers from a uniform distribution that covers the entire interval.
2. "Intermediate precision" entails a certain likelihood that the ecological status or potential has been misassigned. In the randomisation below, 75% of random numbers are drawn from a uniform distribution from the relevant interval, while 12.5% are up to 0.067 nEQR units less than the lower boundary of the interval (i.e. within the upper third of the lower status or potential category), and 12.5% are up to 0.067 nEQR units greater than the upper boundary of the interval (i.e. within the lower third of the higher status or potential category). The latter random numbers are drawn from beta(1,2) distributions (i.e. triangular), assuming decreasing probability with increasing distance from the boundary.
3. "Low precision" entails a considerable likelihood that the ecological status or potential has been misassigned. In the randomisation below, 50% of random numbers are drawn from a uniform distribution from the relevant interval, while 25% are up to 0.2 nEQR units (or one status/potential category) less than the lower boundary of the interval, and 25% are up to 0.2 nEQR units (or one status/potential category) greater than the upper boundary of the interval. The latter random numbers are drawn from beta(1,2) distributions (i.e. triangular), assuming decreasing probability with increasing distance from the boundary. Water bodies with "no information", which are assigned to an ecological status or potential category based on expert judgement, are treated in the same way.

```{r}
set.seed(144)

w <- which(!V$smvf & V$okopre == "Høy")
nEQR[w, ] <-          lowUncertainty(nEQR[w, ], FALSE)
w <- which(!V$smvf & V$okopre == "Middels")
nEQR[w, ] <- intermediateUncertainty(nEQR[w, ], FALSE)
w <- which(!V$smvf & V$okopre != "Høy" & V$okopre != "Middels")
nEQR[w, ] <-         highUncertainty(nEQR[w, ], FALSE)
w <- which( V$smvf & V$okopre == "Høy")
nEQR[w, ] <-          lowUncertainty(nEQR[w, ], TRUE)
w <- which( V$smvf & V$okopre == "Middels")
nEQR[w, ] <- intermediateUncertainty(nEQR[w, ], TRUE)
w <- which( V$smvf & V$okopre != "Høy" & V$okopre != "Middels")
nEQR[w, ] <-         highUncertainty(nEQR[w, ], TRUE)
```

A few water bodies have "not been classified" (i.e. have not been assigned to any status or potential category). 
To these, nEQR values are assigned at random based on the distribution of nEQR among classified water bodies, separately for natural and heavily modified water bodies of each surface water category.

```{r}
for (vannkategori in c("R", "L", "C")) {
  w1 <- which(!V$smvf &  is.na(nEQR[, 1]) & V$kat == vannkategori)
  w2 <- which(!V$smvf & !is.na(nEQR[, 1]) & V$kat == vannkategori)
  if (length(w1)) nEQR[w1, ] <- sample(nEQR[w2, ], length(w1) * nsim)
  w1 <- which( V$smvf &  is.na(nEQR[, 1]) & V$kat == vannkategori)
  w2 <- which( V$smvf & !is.na(nEQR[, 1]) & V$kat == vannkategori)
  if (length(w1)) nEQR[w1, ] <- sample(nEQR[w2, ], length(w1) * nsim)
}

if (any(is.na(nEQR))) {
  cat("NB: Some water bodies have still not been assigned an nEQR value!\n")
} else {
  cat("Everything is fine - all water bodies have an nEQR value.\n")
}
```

### 9.2. Indicator definition A

Indicator definition **A** is the *unweighted proportion of water bodies with at least good ecological status*.

This is the definition that is most in line with Eurostat's wording, which is: "Percentage of lakes and reservoirs / rivers and canals with good ecological status", assuming that the addition of "*at least*" was intended by Eurostat (otherwise, water bodies with *high* ecological status would *reduce* the indicator value). 
All [four inconsistencies](#drawbacks) with SEEA&nbsp;EA apply to this definition, however. 

According to this definition, heavily modified water bodies are treated as having poorer than good ecological status, irrespective of their ecological potential. 
This is in accordance with the definition of heavily modified water bodies ([see above](#reference-levels)).

```{r}
for (vannkategori in c("R", "L", "C")) {
  cat("Surface water category " %+% vannkategori %+% ":\n")
  nEQR. <- nEQR[which(V$kat == vannkategori), ]
  nEQR.[ V$smvf[which(V$kat == vannkategori)],] <- 0
  nEQR.[] <- as.numeric(nEQR.[] > 0.6)
  print(quantile(apply(nEQR., 2, mean), Qnt))
  cat("\n\n")
}
```

### 9.3. Indicator definition B

Indicator definition **B** is the *unweighted proportion of water bodies with at least good ecological status or good ecological potential*.

According to this definition, heavily modified water bodies with good ecological *potential* are treated as if they had good ecological *status*, as is current practice in, e.g., England ([Environment Agency & Natural England 2025](#env25)). 
The [four inconsistencies](#drawbacks) with SEEA&nbsp;EA apply to this definition as well.

```{r}
nEQR. <- nEQR
w1 <- which(!V$smvf)
w2 <- which( V$smvf)
nEQR.[w1, ] <- as.numeric(nEQR.[w1, ] > 0.60)
nEQR.[w2, ] <- as.numeric(nEQR.[w2, ] > 0.45)
for (vannkategori in c("R", "L", "C")) {
  cat("Surface water category " %+% vannkategori %+% ":\n")
  w <- which(V$kat == vannkategori)
  print(quantile(apply(nEQR.[w, ], 2, mean), Qnt))
  cat("\n\n")
}
```

### 9.4. Indicator definition C

Indicator definition **C** is the *size-weighted proportion of water bodies with at least good ecological status*.

This definition deviates somewhat from Eurostat's suggestion, and it violates SEEA&nbsp;EA in terms of [issues 1 to&nbsp;3](#drawbacks). 
A "size-weighted proportion" is calculated by assigning a value of 1 to all water bodies with at least good ecological status and a value of 0 to all water bodies with moderate or poorer ecological status (including all heavily modified water bodies), and calculating a size-weighted average of these values. 
"Size" is understood as area for lake and coastal water bodies and as length of river water bodies.

```{r}
for (vannkategori in c("R", "L", "C")) {
  cat("Surface water category " %+% vannkategori %+% ":\n")
  w <- which(V$kat == vannkategori)
  nEQR. <- nEQR[w, ]
  nEQR.[ V$smvf[w],] <- 0
  nEQR.[] <- as.numeric(nEQR.[] > 0.6)
  print(quantile(apply(nEQR., 2, weighted.mean, w = V$areal[w]), Qnt))
  cat("\n\n")
}
```

### 9.5. Indicator definition D

Indicator definition **D** is the *size-weighted average of ecological status or ecological potential*.

This definition deviates even more from Eurostat's suggestion, and it violates SEEA&nbsp;EA in terms of [issues 1 and&nbsp;2](#drawbacks). 

Ideally, the ecological status of a water bodies should be provided in terms of continuous nEQR scores. 
However, in the *Vann-nett* database, ecological status is only available in terms of categories, which therefore need to be converted into numbers. 
The uncertainty inherent in this step is quantified by using random numbers ([see above](#random)) and reported, as for the other definitions, in terms of quantiles. 
(As long as ecological status is *not* reported in terms of nEQR values, possible values of the indicator are actually between 0.1 and 0.9, rather than between 0.0 and 1.0. 
It would be straightforward to correct for this inconvenience numerically, viz. <span style="white-space:nowrap">`i* = (i - 0.1) * 1.25`.</span> 
This would entail that the "corrected" indicator `i*` is not interpretable as an nEQR any more, however, which is why this correction has not been applied here.)

```{r}
for (vannkategori in c("R", "L", "C")) {
  cat("Surface water category " %+% vannkategori %+% ":\n")
  w <- which(V$kat == vannkategori)
  nEQR. <- nEQR[w, ]
  print(quantile(apply(nEQR., 2, weighted.mean, w = V$areal[w]), Qnt))
  cat("\n\n")
}
```

### 9.6. Comparison

As expected, indicator values estimated in accordance with definition **B** are higher than ones estimated with definition&nbsp;**A**. 
This is because **A** considers all heavily modified water bodies to be in less than "good" status, wheres **B** equates "good potential" with "good status", so that the fraction increases by an amount corresponding to water bodies in the latter condition. 
Both approaches are defendable: 
**A** is obviously in better accordance with the definition of "heavily modified water bodies" ([see above](#reference-levels)), precisely because it implies that "good status" is unachievable for them. 
For water management, however, it is reasonable to concentrate on the "second-best goal" available for such water bodies, which is ensuring "good potential". 
Counting water bodies with "good potential" as a management success, as definition **B** does, therefore makes some sense. 
Such considerations should not normally be allowed to influence an ecosystem condition account however, so that **B** is even less in line with [SEEA&nbsp;EA](#seeaea) than&nbsp;**A**.

The difference between definitions **A** and **C** is that **A** ignores the size of the water bodies. 
As can be seen from the results, this may lead to deviations in both directions. 
In the case of lakes, smaller water bodies have a better ecological status, on average, than larger water bodies. 
Therefore, the area-weighted indicator (**C**) is lower than the unweighted one (**A**). 
For river and coastal water bodies, the reverse seems to be the case, since the size-weighted indicator values are higher than the unweighted ones. 
(It should be mentioned that the area of a lake water body is an ecologically relevant characteristic of the lake, whereas the length of river water bodies and area of coastal water is not, since the delineation of these water bodies is arbitrary.) 
Area-weighted indicators are clearly more in line with SEEA&nbsp;EA ([see above](#drawbacks)).

Finally, the difference between definitions **C** and **D** is that **C** ignores the precise value of the underlying variable by purely counting the proportion of water bodies reaching a certain threshold ([see above](#drawbacks)). 
This can also lead to deviations in both directions. 
For lakes, the *average* ecological status is barely "good" (an approximated mean nEQR of 0.61) -- although less than half of the area covered by lakes (46%) is actually in "good status". 
For coastal water bodies, on the other hand, the area in "good status" (81%) gives a higher indicator value than the average ecological status (0.71). 
In the case of rivers, both figures are surprisingly similar (close to 0.7). 

Of all definitions considered, **D** is closest to the SEEA&nbsp;EA framework. 
However, even this definition has two [incompatibilites](#drawbacks) with SEEA&nbsp;EA (which it shares with definitions **A**--**C**). 
For this reason, we cannot recommend any of the definitions tested. 
Instead of an indicator based on the overall ecological status of water bodies, an ecosystem condition account should rely on the primary indicators underlying the estimate of overall status. 
*If* a single value capturing the ecological status of surface water ecosystems is desirable, it should rather be based on an index calculated from these indicators (as outlined in [section&nbsp;3.3](#collinearities-with-other-indicators) above).

<!--# 
Use this header for documenting the analyses. Put code in separate code chunks, and annotate the code in between using normal text (i.e. between the chunks, and try to avoid too many hashed out comments inside the code chunks). Add subheaders as needed. 

Code folding is activated, meaning the code will be hidden by default in the html (one can click to expand it).

Caching is also activated (from the top YAML), meaning that rendering to html will be quicker the second time you do it. This will create a folder inside you project folder (called INDICATORID_cache). Sometimes caching created problems because some operations are not rerun when they should be rerun. Try deleting the cash folder and try again.
-->


## 10. Results

The results are here tabulated separately for the three surface water categories (which correspond to ecosystem types sensu [SEEA&nbsp;EA](#seeaea)) and four indicator definitions. 
*Note that we [cannot recommend any of the definitions](#comparison)*.

The estimates are based on 10,000 iterations and therefore differ from the ones above, which were based on 1,000 iterations only. 
*Note also that estimates are for August 2025 rather than for 2024* ([see above](#vann-nett)).

### 10.1. Rivers

| Indicator ID | Definition                        | Best estimate | Lower quartile | Upper quartile |
|:-------------|:---------------------------------:|:-------------:|:--------------:|:--------------:|
| NO_WECO_001  | [Def. A](#indicator-definition-a) | 0.572         | 0.571          | 0.573          |
| NO_WECO_004  | [Def. B](#indicator-definition-b) | 0.605         | 0.604          | 0.606          |
| NO_WECO_007  | [Def. C](#indicator-definition-c) | 0.697         | 0.694          | 0.700          |
| NO_WECO_010  | [Def. D](#indicator-definition-d) | 0.696         | 0.694          | 0.697          |

: Indicator values for different definitions of ecological status of rivers in Norway in 2025 {.striped .hover}

### 10.2. Lakes

| Indicator ID | Definition                        | Best estimate | Lower quartile | Upper quartile |
|:-------------|:---------------------------------:|:-------------:|:--------------:|:--------------:|
| NO_WECO_002  | [Def. A](#indicator-definition-a) | 0.594         | 0.591          | 0.596          |
| NO_WECO_005  | [Def. B](#indicator-definition-b) | 0.680         | 0.677          | 0.683          |
| NO_WECO_008  | [Def. C](#indicator-definition-c) | 0.461         | 0.457          | 0.463          |
| NO_WECO_011  | [Def. D](#indicator-definition-d) | 0.605         | 0.603          | 0.608          |

: Indicator values for different definitions of ecological status of lakes in Norway in 2025 {.striped .hover}

### 10.3. Coastal waters

| Indicator ID | Definition                        | Best estimate | Lower quartile | Upper quartile |
|:-------------|:---------------------------------:|:-------------:|:--------------:|:--------------:|
| NO_WECO_003  | [Def. A](#indicator-definition-a) | 0.625         | 0.620          | 0.629          |
| NO_WECO_006  | [Def. B](#indicator-definition-b) | 0.632         | 0.628          | 0.637          |
| NO_WECO_009  | [Def. C](#indicator-definition-c) | 0.808         | 0.791          | 0.822          |
| NO_WECO_012  | [Def. D](#indicator-definition-d) | 0.709         | 0.703          | 0.714          |

: Indicator values for different definitions of ecological status of coastal waters in Norway in 2025 {.striped .hover}

<!--# 
Repeat the final results here. Typically this is a map or table of indicator values.

This is typically where people will harvest data from, so make sure to include all relevant output here, but don't clutter this section with too much output either.
-->

<!--# 
## 11. Export file

Optional: Display the code (don't execute it) or the workflow for exporting the indicator values to file. Ideally the indicator values are exported as a georeferenced shape or raster file with indicators values, reference values and errors. You can also chose to export the raw (un-normalised or unscaled variable) as a seperate product. You should not save large sptaial output data on GitHub. You can use eval=FALSE to avoid code from being executed (example below - delete if not relevant) 
-->

```{r export}
#| eval: false
```
